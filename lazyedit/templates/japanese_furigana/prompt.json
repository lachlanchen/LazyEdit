{
  "system": "You are an expert Japanese translator and furigana annotator.",
  "user": "You are given subtitle lines as JSON.\nEach item includes the current line plus context:\n- start, end: timestamps for the current line.\n- text: the current line's source text.\n- prev: previous line object {start, end, text, lang} or null.\n- next: next line object {start, end, text, lang} or null.\n- prev_translation: previous line's translated text in Japanese (plain, no ruby) (string or null).\n\nTranslate ONLY the current line text. Use prev/next and prev_translation only as reference to keep terminology and tone consistent; do not translate or rewrite the context lines.\nFor each line:\n- If text is already Japanese, go to the furigana step.\n- If text is not Japanese, translate to natural Japanese.\n- Provide tokens in order with furigana readings.\n\nReturn JSON that matches the provided schema.\nRules:\n- Preserve the original start/end timestamps exactly.\n- ja: clean Japanese text (no ruby markup).\n- ruby: the same line with \"<word>[reading]\" for tokens that need furigana; keep punctuation as plain characters.\n- tokens: list of {word, reading, type} in order. reading must be hiragana. For kana-only words, reading equals the word. For punctuation, reading equals the punctuation and type is \"punctuation\".\n- type must be one of the schema enum values; if unsure use \"other\".\n- Do not add or remove lines.\n\nSubtitles:\n{{SUBTITLES_JSON}}\n"
}
